<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Wrenchly – Auto-onderhoud</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Host+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Host Grotesk', sans-serif; background: #f9fafb; color: #111827; }
    .tab { @apply px-4 py-2 rounded-lg border text-sm sm:text-base transition; }
    .tab-active { background-color: white; border-color: #e5e7eb; font-weight: 600; box-shadow: 0 1px 3px rgba(0,0,0,0.08); }
    tr:hover { background-color: #f0f8ff; }
  </style>
</head>

<body class="p-4 sm:p-8">
  <main class="max-w-6xl mx-auto bg-white rounded-3xl shadow-sm p-6 sm:p-10">
    <header class="mb-6 flex flex-col sm:flex-row sm:items-center sm:justify-between">
      <h1 class="text-2xl sm:text-3xl font-bold mb-2 sm:mb-0">Wrenchly – Onderhoudsoverzicht</h1>
      <div class="flex gap-2">
        <button id="tabReparaties" class="tab tab-active border rounded-lg">Reparaties</button>
        <button id="tabServiceboekje" class="tab border rounded-lg">Serviceboekje</button>
      </div>
    </header>

    <!-- Reparaties tabel -->
    <div id="reparatiesContainer">
      <table class="min-w-full border-collapse text-sm sm:text-base">
        <thead class="bg-gray-100">
          <tr>
            <th class="text-left px-3 py-2">Datum</th>
            <th class="text-left px-3 py-2">Garage</th>
            <th class="text-left px-3 py-2">Totaalbedrag</th>
          </tr>
        </thead>
        <tbody id="reparatiesBody"></tbody>
      </table>
    </div>

    <!-- Serviceboekje -->
    <div id="serviceContainer" class="hidden">
      <div class="mb-4">
        <label for="serviceFilter" class="text-sm font-medium mr-2">Filter:</label>
        <select id="serviceFilter" class="border rounded-lg px-3 py-1.5 text-sm focus:ring-2 focus:ring-blue-500">
          <option value="alle">Alle</option>
          <option value="historisch">Historisch</option>
          <option value="toekomstig">Toekomstig</option>
        </select>
      </div>

      <table class="min-w-full border-collapse text-sm sm:text-base">
        <thead class="bg-gray-100">
          <tr>
            <th class="text-left px-3 py-2">Datum</th>
            <th class="text-left px-3 py-2">Soort onderhoud</th>
            <th class="text-left px-3 py-2">Kilometerstand</th>
            <th class="text-left px-3 py-2">Uitgevoerd door</th>
            <th class="text-left px-3 py-2">Opmerkingen</th>
          </tr>
        </thead>
        <tbody id="serviceBody"></tbody>
      </table>
    </div>
  </main>

  <script>
    const tabReparaties = document.getElementById('tabReparaties');
    const tabServiceboekje = document.getElementById('tabServiceboekje');
    const reparatiesContainer = document.getElementById('reparatiesContainer');
    const serviceContainer = document.getElementById('serviceContainer');
    const serviceFilter = document.getElementById('serviceFilter');
    const reparatiesBody = document.getElementById('reparatiesBody');
    const serviceBody = document.getElementById('serviceBody');

    let data = {};

    async function loadData() {
      const res = await fetch('data.json');
      data = await res.json();
      renderReparaties();
      renderService();
    }

    // --- TABS ---
    tabReparaties.addEventListener('click', () => {
      tabReparaties.classList.add('tab-active');
      tabServiceboekje.classList.remove('tab-active');
      reparatiesContainer.classList.remove('hidden');
      serviceContainer.classList.add('hidden');
    });

    tabServiceboekje.addEventListener('click', () => {
      tabServiceboekje.classList.add('tab-active');
      tabReparaties.classList.remove('tab-active');
      serviceContainer.classList.remove('hidden');
      reparatiesContainer.classList.add('hidden');
    });

    // --- RENDER REPARATIES ---
    function renderReparaties() {
      reparatiesBody.innerHTML = '';
      const bonnen = data.bonnen || [];
      bonnen.forEach((factuur, index) => {
        const mainRow = document.createElement('tr');
        mainRow.className = "cursor-pointer border-b";
        mainRow.innerHTML = `
          <td class="px-3 py-2">${factuur.factuurdatum}</td>
          <td class="px-3 py-2">${factuur.garage}</td>
          <td class="px-3 py-2">€ ${factuur.totaal.toFixed(2)}</td>
        `;
        reparatiesBody.appendChild(mainRow);

        const details = [
          {label: "Factuurnummer", value: factuur.factuurnummer},
          {label: "Kilometerstand", value: factuur.kilometerstand},
          {label: "Omschrijving", value: factuur.omschrijving},
          {label: "Categorie", value: factuur.categorie}
        ];
        details.forEach(d => {
          const detailRow = document.createElement('tr');
          detailRow.className = "hidden bg-gray-50";
          detailRow.innerHTML = `<td colspan="3" class="px-3 py-2 text-gray-700 text-sm"><strong>${d.label}:</strong> ${d.value}</td>`;
          reparatiesBody.appendChild(detailRow);
          mainRow.addEventListener('click', () => {
            detailRow.classList.toggle('hidden');
          });
        });
      });
    }

    // --- RENDER SERVICE ---
    function renderService() {
      serviceBody.innerHTML = '';
      const filter = serviceFilter.value;
      const beurten = data.service || [];
      const vandaag = new Date();

      beurten.forEach(beurt => {
        const beurtDatum = new Date(beurt.datum);
        const isHistorisch = beurtDatum <= vandaag;
        if (filter === 'historisch' && !isHistorisch) return;
        if (filter === 'toekomstig' && isHistorisch) return;

        const row = document.createElement('tr');
        row.className = "border-b";
        row.innerHTML = `
          <td class="px-3 py-2">${beurt.datum}</td>
          <td class="px-3 py-2">${beurt.soort_onderhoud}</td>
          <td class="px-3 py-2">${beurt.kilometerstand}</td>
          <td class="px-3 py-2">${beurt.uitgevoerd_door}</td>
          <td class="px-3 py-2">${beurt.opmerkingen || ''}</td>
        `;
        serviceBody.appendChild(row);
      });
    }

    serviceFilter.addEventListener('change', renderService);
    loadData();
  </script>
</body>
</html>
